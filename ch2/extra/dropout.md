本部分基于https://zhuanlan.zhihu.com/p/38200980这篇文章进行修改

## 1. Dropout简介

### 1.1 Dropout出现的原因

在本节的笔记中说过，人工神经网络的本质是对于训练集决策边界的拟合，神经元的数量多和网络结构复杂都有利于对复杂边界的拟合。

但是如果模型的参数太多，而训练样本又太少，训练出来的模型很容易产生过拟合的现象。过拟合的原因是参数过多学习了训练集的决策边界而偏离了对整体样本空间决策边界。

在训练神经网络的时候经常会遇到过拟合的问题，过拟合具体表现在：模型在训练数据上损失函数较小，预测准确率较高；但是在测试数据上损失函数比较大，预测准确率较低。

![机器学习中的“过拟合”与“欠拟合”场景描述在模型评估与调整的过程中，我们往往遇到“过拟合”或“欠拟合”的情况。如何有效-](assets\66ada498de2d4b55bd92b23d0055a6cbtplv-k3u1fbpfcp-zoom-in-crop-mark1512000.webp)

过拟合是很多机器学习的通病。如果模型过拟合，那么得到的模型几乎不能用。为了解决过拟合问题，一般会采用模型集成的方法，即训练多个模型进行组合。此时，训练模型费时就成为一个很大的问题，不仅训练多个模型费时，测试多个模型也是很费时。

综上所述，训练深度神经网络的时候，总是会遇到两大缺点：

（1）容易过拟合

（2）费时

Dropout可以比较有效的缓解过拟合的发生，在一定程度上达到正则化的效果。



### 1.2 什么是Dropout

Dropout可以作为训练深度神经网络的一种trick供选择。在每个训练批次中，通过忽略特定比例的特征检测器（让一半的隐层节点值为0），可以明显地减少过拟合现象。这种方式可以减少特征检测器（隐层节点）间的相互作用，检测器相互作用是指某些检测器依赖其他检测器才能发挥作用。

Dropout说的简单一点就是：我们在前向传播的时候，让某个神经元的激活值以一定的概率p停止工作，这样可以避免模型过度学习训练集的特征，使模型泛化性更强，如图1所示。

![img](assets\v2-5530bdc5d49f9e261975521f8afd35e9_1440w.jpg)

需要注意的是，**被drop的神经元在这一轮的反向传播中不会更新参数**，即dropout也会或多或少的增加学习时间



## 2. 为什么说Dropout可以解决过拟合

**（1）取平均的作用：** 先回到标准的模型即没有dropout，我们用相同的训练数据去训练5个不同的神经网络，一般会得到5个不同的结果，此时我们可以采用 “5个结果取均值”或者“多数取胜的投票策略”去决定最终结果。例如3个网络判断结果为数字9,那么很有可能真正的结果就是数字9，其它两个网络给出了错误结果。这种“综合起来取平均”的策略通常可以有效防止过拟合问题。因为不同的网络可能产生不同的过拟合，取平均则有可能让一些“相反的”拟合互相抵消。dropout掉不同的隐藏神经元就类似在训练不同的网络，随机删掉一半隐藏神经元导致网络结构已经不同，整个dropout过程就相当于对很多个不同的神经网络取平均。而不同的网络产生不同的过拟合，一些互为“反向”的拟合相互抵消就可以达到整体上减少过拟合。

**（2）减少神经元之间复杂的共适应关系：** 因为dropout程序导致两个神经元不一定每次都在一个dropout网络中出现。这样权值的更新不再依赖于有固定关系的隐含节点的共同作用，阻止了某些特征仅仅在其它特定特征下才有效果的情况 。迫使网络去学习更加鲁棒的特征 ，这些特征在其它的神经元的随机子集中也存在。换句话说假如我们的神经网络是在做出某种预测，它不应该对一些特定的线索片段太过敏感，即使丢失特定的线索，它也应该可以从众多其它线索中学习一些共同的特征。从这个角度看dropout就有点像L1，[L2正则](https://zhida.zhihu.com/search?content_id=7471881&content_type=Article&match_order=1&q=L2正则&zhida_source=entity)，减少权重使得网络对丢失特定神经元连接的鲁棒性提高。

（3）**Dropout类似于性别在生物进化中的角色：**物种为了生存往往会倾向于适应这种环境，环境突变则会导致物种难以做出及时反应，性别的出现可以繁衍出适应新环境的变种，有效的阻止过拟合，即避免环境改变时物种可能面临的灭绝。